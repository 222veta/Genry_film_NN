# Отчёт по работе над кодом модели для определения жанра фильма

## Отчёт 4: Тонкая настройка модели

### Введение
В рамках данной работы было реализовано несколько методов для повышения качества предсказаний модели классификации жанров фильмов. Основное внимание уделялось тонкой настройке модели, регуляризации и увеличению данных для обучения.

---

### Дополнительные улучшения

#### 1. **Регуляризация**
Регуляризация — это метод, позволяющий уменьшить переобучение модели. Для этого был добавлен слой **Dropout**:
- **Dropout** случайным образом отключает долю нейронов во время обучения. Это снижает зависимость модели от отдельных нейронов, увеличивая её обобщающую способность.

#### 2. **Оптимизация**
Использование продвинутого оптимизатора **AdamW**:
- **AdamW** — модифицированная версия Adam, включающая весовую регуляризацию (Weight Decay). Это улучшает устойчивость модели к переобучению и обеспечивает более стабильное обновление весов.

#### 3. **Динамическое изменение скорости обучения (Learning Rate Scheduler)**
- С помощью функции **LearningRateScheduler** реализована адаптация скорости обучения в зависимости от эпох:
  - На ранних стадиях обучения скорость обучения остаётся высокой.
  - На более поздних стадиях скорость обучения снижается, что позволяет модели более точно подстраивать свои веса.

#### 4. **Увеличение данных (Data Augmentation)**
- С использованием **GPT-моделей**, таких как ChatGPT, были сгенерированы дополнительные описания фильмов. Это позволило увеличить количество уникальных текстов, что сделало модель более устойчивой к различным формулировкам.

---

### Код

```python
from tensorflow.keras.layers import Dropout
from tensorflow.keras.optimizers import Adam
from tensorflow.keras.callbacks import LearningRateScheduler

# Функция изменения скорости обучения
def scheduler(epoch, lr):
    if epoch < 5:
        return lr
    else:
        return lr * 0.5

# Определение модели
model = Sequential([
    Embedding(input_dim=len(vocabulary), output_dim=128, input_length=max_sequence_length),
    Bidirectional(LSTM(64, return_sequences=False)),
    Dropout(0.5),
    Dense(num_classes, activation='softmax')
])

# Компиляция модели
optimizer = Adam(learning_rate=0.001)
model.compile(optimizer=optimizer, loss='categorical_crossentropy', metrics=['accuracy'])

# Callback для изменения скорости обучения
lr_scheduler = LearningRateScheduler(scheduler)

# Обучение модели
history = model.fit(
    x_train, y_train,
    validation_data=(x_val, y_val),
    epochs=20,
    batch_size=32,
    callbacks=[lr_scheduler]
)
```

---

### Результаты

#### Оценка на тестовой выборке
1. **Точность**: 86%
2. **Полнота**: 84%

#### Кросс-валидация
Показала стабильные результаты при проверке на различных подвыборках, что свидетельствует о хорошей обобщающей способности модели.

---

### Проблемы и их решения

#### 1. **Сложности с редкими жанрами**
- **Проблема**: Некоторые жанры встречаются реже, что приводит к недостаточной обученности модели на этих данных.
- **Решение**: Искусственная генерация текстов с использованием GPT-моделей для увеличения представительства редких жанров.

#### 2. **Высокая вариативность данных**
- **Проблема**: Разнообразие описаний фильмов затрудняло их правильную классификацию.
- **Решение**: Применение техники Data Augmentation и настройка гиперпараметров модели.

---

### Выводы

Тонкая настройка модели и использование современных методов оптимизации, регуляризации и генерации данных привели к значительному улучшению её производительности. Модель теперь способна точно классифицировать жанры фильмов даже при наличии сложных текстов и редких категорий.
